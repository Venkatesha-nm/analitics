{"job":{"components":{"7161":{"id":7161,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":800,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[7207],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_worldclockapi_utc"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_worldclockapi_utc"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currentDateTime"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"currentFileTime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dayOfTheWeek"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"timeZoneName"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7162":{"id":7162,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":800,"y":464,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[7204],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_worldclockapi_type2"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_worldclockapi_type2"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"timeZoneName"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"currentDateTime"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"currentFileTime"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"dayOfTheWeek"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"ValidFrom"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ValidTo"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Version"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CurrentFlag"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7163":{"id":7163,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":1024,"y":320,"width":32,"height":32,"inputConnectorIDs":[7207],"outputConnectorIDs":[7208],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank 0"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns.","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"timeZoneName"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currentDateTime"},"2":{"slot":2,"type":"STRING","value":"Desc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rn"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7164":{"id":7164,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1152,"y":320,"width":32,"height":32,"inputConnectorIDs":[7208],"outputConnectorIDs":[7205],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Deduplicate"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rn"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7165":{"id":7165,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":1152,"y":464,"width":32,"height":32,"inputConnectorIDs":[7204],"outputConnectorIDs":[7206],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Current only"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT *\nFROM $T{dim_worldclockapi_type2}\nWHERE \"CurrentFlag\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7166":{"id":7166,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":1392,"y":384,"width":32,"height":32,"inputConnectorIDs":[7205,7206],"outputConnectorIDs":[7202],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes 0"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Current only"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"timeZoneName"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currentDateTime"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"currentFileTime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dayOfTheWeek"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_currentDateTime"},"2":{"slot":2,"type":"STRING","value":"master_currentDateTime"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_currentDateTime"},"2":{"slot":2,"type":"STRING","value":"compare_currentDateTime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"master_currentFileTime"},"2":{"slot":2,"type":"STRING","value":"master_currentFileTime"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_currentFileTime"},"2":{"slot":2,"type":"STRING","value":"compare_currentFileTime"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"master_dayOfTheWeek"},"2":{"slot":2,"type":"STRING","value":"master_dayOfTheWeek"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dayOfTheWeek"},"2":{"slot":2,"type":"STRING","value":"compare_dayOfTheWeek"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"master_Version"},"2":{"slot":2,"type":"STRING","value":"prior_version"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7167":{"id":7167,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1728,"y":384,"width":32,"height":32,"inputConnectorIDs":[7203],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite tmp Table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_worldclockapi_utc_delta"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"7201":{"id":7201,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1536,"y":384,"width":32,"height":32,"inputConnectorIDs":[7202],"outputConnectorIDs":[7203],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add load date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_TRUNC('SECOND', TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP))"},"2":{"slot":2,"type":"STRING","value":"load_timestamp"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"7202":{"id":7202,"sourceID":7166,"targetID":7201},"7203":{"id":7203,"sourceID":7201,"targetID":7167},"7204":{"id":7204,"sourceID":7162,"targetID":7165},"7205":{"id":7205,"sourceID":7164,"targetID":7166},"7206":{"id":7206,"sourceID":7165,"targetID":7166},"7207":{"id":7207,"sourceID":7161,"targetID":7163},"7208":{"id":7208,"sourceID":7163,"targetID":7164}},"notes":{"7156":{"id":7156,"x":776,"y":149,"width":419,"height":40,"text":"This is a \"type 2\" dimension update.\nIt always creates a new row if anything has changed.","colour":"00ce4f"},"7157":{"id":7157,"x":715,"y":257,"width":175,"height":104,"text":"This is the new data","colour":"00ce4f"},"7158":{"id":7158,"x":714,"y":412,"width":176,"height":96,"text":"This is the existing data","colour":"00ce4f"},"7159":{"id":7159,"x":937,"y":256,"width":319,"height":105,"text":"It is important to make sure the intended primary key is unique, otherwise it can break the following change detection","colour":"f9c21b"},"7160":{"id":7160,"x":1628,"y":184,"width":361,"height":256,"text":"It is important that you do **not** insert and update the actual dimension table here. If you do add both a Table Update and a Table Output, multiple DML statements are generated and the results can be non deterministic.\n\nInstead, persist the intermediate results and continue with part 2.\n\nFor more information and background on this, please refer to\n[[https://www.matillion.com/resources/developer-relations/developing-workflows-in-matillion-etl]]\n","colour":"f9c21b"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example scd type 2 update part 1","description":null,"type":"TRANSFORMATION","tag":"07b38b14-c566-4a33-9ebb-d6759fc783b9"}}